(()=>{"use strict";var e;!function(e){e.spinStart="spinstart",e.spining="spining",e.spinEnd="spinend",e.change="change",e.changed="changed"}(e||(e={}));const t=e;function n(e,t,n,r){t.forEach((t=>{!function(e,t,n,r){e.addEventListener(t,n,r)}(e,t,n,r)}))}function r(e,t,n,r){t.forEach((t=>{e.removeEventListener(t,n,r)}))}function s(e,t,n){return t.every((t=>function(e,t,n){return e.dispatchEvent(new CustomEvent(t,n))}(e,t,n)))}const i=function(e){if(e instanceof MouseEvent)return{x:e.clientX,y:e.clientY};if(e instanceof TouchEvent){const{touches:[t]}=e;return{x:t.clientX,y:t.clientY}}throw new ReferenceError(`Illegal event: ${e}`)},{PI:a,hypot:o,asin:d}=Math,c={x:0,y:0};function h(e,t=c){return e.y<t.y?e.x>t.x?1:2:e.x<t.x?3:e.y>t.y?4:1}function g(e,t=c,n=h(e,t)){const r=e.x-t.x,s=e.y-t.y,i=o(r,s);switch(n){default:case 1:return d(-s/i);case 2:return d(-r/i);case 3:return d(s/i);case 4:return d(r/i)}}const u=["mousedown","touchstart"],m=["mousemove","touchmove"],l=["mouseup","touchend"],f=[t.spinStart],b=[t.spining,t.change],x=[t.spinEnd,t.changed];function p(e){const{degree:t}=this;if(!s(this,f,{detail:{degree:t,offsetDegree:0}}))return;const{top:o,right:d,bottom:c,left:u}=this.getBoundingClientRect(),p={x:(d+u)/2,y:(o+c)/2},v=i(e),E=h(v,p),w=g(v,p,E);let y=0,D=E,$=w;const k=e=>{const n=i(e),r=h(n,p),o=g(n,p,r),d=function(e,t,n,r){switch(n-e){default:case 0:return t-r;case-3:case 1:return r+(a/2-t);case-1:case 3:return t+(a/2-r);case-2:case 2:{const e=t+a-r;return e>a?2*a-e:e}}}(D,$,r,o);y+=d/a*180;const c=t+y,u=s(this,b,{detail:{degree:c,offsetDegree:y}});D=r,$=o,u&&(this.degree=c)},M=()=>{const{degree:e}=this,t={detail:{degree:e,offsetDegree:y}};r(document,m,k),r(document,l,M),s(this,x,t)};e.preventDefault(),n(document,m,k),n(document,l,M)}var v;!function(e){e.disabled="disabled",e.degree="degree",e.minDegree="min",e.maxDegree="max"}(v||(v={}));const E=v,{isNaN:w}=globalThis,y=document.createElement("template");y.innerHTML="\n<style>\n  :host {\n    display: inline-block;\n    transform: rotate(var(--degree));\n  }\n</style>\n<slot>\n</slot>\n";class D extends HTMLElement{static get nodeName(){return"knob-base"}#disabled=!1;#minDegree=-1/0;#maxDegree=1/0;#degree=0;constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot.append(y.content.cloneNode(!0)),Object.values(E).forEach((e=>{this.attributeChangedCallback(e)}))}static get observedAttributes(){return[E.disabled,E.minDegree,E.maxDegree,E.degree]}attributeChangedCallback(e){switch(e){default:break;case E.disabled:this.disabled=this.hasAttribute(E.disabled);break;case E.minDegree:this.min=Number(this.getAttribute(E.minDegree)??-1/0),this.degree=Math.max(this.min,this.degree);break;case E.maxDegree:this.max=Number(this.getAttribute(E.maxDegree)??1/0),this.degree=Math.min(this.max,this.degree);break;case E.degree:this.degree=Number(this.getAttribute(E.degree)??0)}}get disabled(){return this.#disabled}set disabled(e){const t=Boolean(e);t?r(this,u,p):n(this,u,p),this.#disabled=t}get min(){return this.#minDegree}set min(e){if(w(e))throw new TypeError(`Invalid min degree: ${e}`);if(this.max<e)throw new RangeError(`Unable to set min degree that is greater than max degree: ${e} > ${this.max}`);this.#minDegree=e}get max(){return this.#maxDegree}set max(e){if(w(e))throw new TypeError(`Invalid max degree: ${e}`);if(this.min>e)throw new RangeError(`Unable to set max degree that is less than min degree: ${e} < ${this.min}`);this.#maxDegree=e}get degree(){return this.#degree}set degree(e){if(e===this.degree)return;if(w(e))throw new TypeError(`Invalid degree: ${e}`);const t=Math.max(Math.min(e,this.max),this.min);this.style.setProperty("--degree",`${t}deg`),this.#degree=t}get value(){return this.degree}set value(e){this.degree=e}}const $=D,k=$.nodeName;customElements.get(k)?console.warn(`Already defined <${k}>`):customElements.define(k,$),customElements.whenDefined(k).then((()=>{console.info(`Knob.js is defined as <${k}>`)}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TixHQUN4Qk8sTUFBSyxLQUNKSixRQUFRSyxLQUFNLDBCQUF5QlIsVSIsInNvdXJjZXMiOlsid2VicGFjazovL0BsZjJjb20va25vYi5qcy8uL3NyYy92YWx1ZXMvZXZlbnRzLnRzIiwid2VicGFjazovL0BsZjJjb20va25vYi5qcy8uL3NyYy91dGlscy9ldmVudEhhbmRsZXIudHMiLCJ3ZWJwYWNrOi8vQGxmMmNvbS9rbm9iLmpzLy4vc3JjL3V0aWxzL2dldEV2ZW50WFkudHMiLCJ3ZWJwYWNrOi8vQGxmMmNvbS9rbm9iLmpzLy4vc3JjL3V0aWxzL3JhZGl1c0FuZERlZ3JlZS50cyIsIndlYnBhY2s6Ly9AbGYyY29tL2tub2IuanMvLi9zcmMvdXRpbHMvc3Bpbkxpc3RlbmVyLnRzIiwid2VicGFjazovL0BsZjJjb20va25vYi5qcy8uL3NyYy92YWx1ZXMvYXR0cmlidXRlcy50cyIsIndlYnBhY2s6Ly9AbGYyY29tL2tub2IuanMvLi9zcmMva25vYi50cyIsIndlYnBhY2s6Ly9AbGYyY29tL2tub2IuanMvLi9zcmMvaW5kZXgudHMiXSwic291cmNlc0NvbnRlbnQiOlsiZW51bSBFdmVudHMge1xuICBzcGluU3RhcnQgPSAnc3BpbnN0YXJ0JyxcbiAgc3BpbmluZyA9ICdzcGluaW5nJyxcbiAgc3BpbkVuZCA9ICdzcGluZW5kJyxcbiAgY2hhbmdlID0gJ2NoYW5nZScsXG4gIGNoYW5nZWQgPSAnY2hhbmdlZCcsXG59XG5cbmV4cG9ydCBkZWZhdWx0IEV2ZW50cztcbiIsInR5cGUgRXZlbnRIb2xkZXIgPSBIVE1MRWxlbWVudCB8IERvY3VtZW50IHwgV2luZG93O1xudHlwZSBFdmVudExpc3RlbmVyID0gKC4uLmFyZ3M6IGFueVtdKSA9PiB2b2lkO1xuXG5pbnRlcmZhY2UgRXZlbnRMaXN0ZW5lck9wdGlvbnMge1xuICBjYXB0dXJlPzogYm9vbGVhbjtcbiAgb25jZT86IGJvb2xlYW47XG4gIHBhc3NpdmU/OiBib29sZWFuO1xufVxuXG4vKipcbiAqIEFkZHMgZXZlbnQgb2YgdHlwZSB0byBlbGVtZW50LlxuICovXG5leHBvcnQgZnVuY3Rpb24gYWRkRXZlbnRMaXN0ZW5lcihcbiAgcmVmOiBFdmVudEhvbGRlcixcbiAgdHlwZTogc3RyaW5nLFxuICBsaXN0ZW5lcjogRXZlbnRMaXN0ZW5lcixcbiAgb3B0aW9ucz86IEV2ZW50TGlzdGVuZXJPcHRpb25zLFxuKTogdm9pZCB7XG4gIHJlZi5hZGRFdmVudExpc3RlbmVyKHR5cGUsIGxpc3RlbmVyLCBvcHRpb25zKTtcbn1cblxuLyoqXG4gKiBBZGRzIGV2ZW50cyBvZiB0eXBlcyB0byBlbGVtZW50LlxuICovXG5leHBvcnQgZnVuY3Rpb24gYWRkRXZlbnRMaXN0ZW5lcnMoXG4gIHJlZjogRXZlbnRIb2xkZXIsXG4gIHR5cGVzOiBzdHJpbmdbXSxcbiAgbGlzdGVuZXI6IEV2ZW50TGlzdGVuZXIsXG4gIG9wdGlvbnM/OiBFdmVudExpc3RlbmVyT3B0aW9ucyxcbik6IHZvaWQge1xuICB0eXBlcy5mb3JFYWNoKCh0eXBlKSA9PiB7XG4gICAgYWRkRXZlbnRMaXN0ZW5lcihyZWYsIHR5cGUsIGxpc3RlbmVyLCBvcHRpb25zKTtcbiAgfSk7XG59XG5cbi8qKlxuICogUmVtb3ZlcyBldmVudCBvZiB0eXBlIGZyb20gZWxlbWVudC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZUV2ZW50TGlzdGVuZXIoXG4gIHJlZjogRXZlbnRIb2xkZXIsXG4gIHR5cGU6IHN0cmluZyxcbiAgbGlzdGVuZXI6IEV2ZW50TGlzdGVuZXIsXG4gIG9wdGlvbnM/OiBFdmVudExpc3RlbmVyT3B0aW9ucyxcbik6IHZvaWQge1xuICByZWYucmVtb3ZlRXZlbnRMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lciwgb3B0aW9ucyk7XG59XG5cbi8qKlxuICogUmVtb3ZlcyBldmVudHMgb2YgdHlwZXMgZnJvbSBlbGVtZW50LlxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVtb3ZlRXZlbnRMaXN0ZW5lcnMoXG4gIHJlZjogRXZlbnRIb2xkZXIsXG4gIHR5cGVzOiBzdHJpbmdbXSxcbiAgbGlzdGVuZXI6IEV2ZW50TGlzdGVuZXIsXG4gIG9wdGlvbnM/OiBFdmVudExpc3RlbmVyT3B0aW9ucyxcbik6IHZvaWQge1xuICB0eXBlcy5mb3JFYWNoKCh0eXBlKSA9PiB7XG4gICAgcmVmLnJlbW92ZUV2ZW50TGlzdGVuZXIodHlwZSwgbGlzdGVuZXIsIG9wdGlvbnMpO1xuICB9KTtcbn1cblxuaW50ZXJmYWNlIEN1c3RvbUV2ZW50SW5pdDxUID0gdW5rbm93bj4ge1xuICBkZXRhaWw/OiBUO1xuICBidWJibGVzPzogYm9vbGVhbjtcbiAgY2FuY2VsYWJsZT86IGJvb2xlYW47XG4gIGNvbXBvc2VkPzogYm9vbGVhbjtcbn1cblxuLyoqXG4gKiBUcmlnZ2VycyBldmVudCBhbmQgcmV0dXJucyBmYWxzZSBpZiB0aGUgZXZlbnQgaXMgY2FuY2VsbGVkLlxuICovXG5leHBvcnQgZnVuY3Rpb24gdHJpZ2dlckV2ZW50PFQ+KFxuICByZWY6IEV2ZW50SG9sZGVyLFxuICB0eXBlOiBzdHJpbmcsXG4gIG9wdGlvbnM/OiBDdXN0b21FdmVudEluaXQ8VD4sXG4pOiBib29sZWFuIHtcbiAgcmV0dXJuIHJlZi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCh0eXBlLCBvcHRpb25zKSk7XG59XG5cbi8qKlxuICogVHJpZ2dlcnMgZXZlbnRzIGFuZCByZXR1cm5zIGZhbHNlIGlmIGFueSBvZiB0aGUgZXZlbnQgaXNcbiAqIGNhbmNlbGxlZC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRyaWdnZXJFdmVudHM8VD4oXG4gIHJlZjogRXZlbnRIb2xkZXIsXG4gIHR5cGVzOiBzdHJpbmdbXSxcbiAgb3B0aW9ucz86IEN1c3RvbUV2ZW50SW5pdDxUPixcbik6IGJvb2xlYW4ge1xuICByZXR1cm4gdHlwZXMuZXZlcnkoKHR5cGUpID0+IHRyaWdnZXJFdmVudChyZWYsIHR5cGUsIG9wdGlvbnMpKTtcbn1cbiIsImltcG9ydCBQb2ludCBmcm9tICcuL1BvaW50JztcblxuLyoqXG4gKiBSZXR1cm5zICh4LCB5KSBvZiBtb3VzdC90b3VjaCBldmVudC5cbiAqL1xuZnVuY3Rpb24gZ2V0RXZlbnRYWShldmVudDogTW91c2VFdmVudCB8IFRvdWNoRXZlbnQpOiBQb2ludCB7XG4gIGlmIChldmVudCBpbnN0YW5jZW9mIE1vdXNlRXZlbnQpIHtcbiAgICByZXR1cm4ge1xuICAgICAgeDogZXZlbnQuY2xpZW50WCxcbiAgICAgIHk6IGV2ZW50LmNsaWVudFksXG4gICAgfTtcbiAgfVxuICBpZiAoZXZlbnQgaW5zdGFuY2VvZiBUb3VjaEV2ZW50KSB7XG4gICAgY29uc3QgeyB0b3VjaGVzOiBbdG91Y2hdIH0gPSBldmVudDtcbiAgICByZXR1cm4ge1xuICAgICAgeDogdG91Y2guY2xpZW50WCxcbiAgICAgIHk6IHRvdWNoLmNsaWVudFksXG4gICAgfTtcbiAgfVxuXG4gIHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihgSWxsZWdhbCBldmVudDogJHtldmVudH1gKTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZ2V0RXZlbnRYWTtcbiIsImltcG9ydCBQb2ludCBmcm9tICcuL1BvaW50JztcblxuY29uc3QgeyBQSSwgaHlwb3QsIGFzaW4gfSA9IE1hdGg7XG5jb25zdCBvcmlnaW5Qb2ludDogUG9pbnQgPSB7IHg6IDAsIHk6IDAgfTtcblxudHlwZSBRdWFkcmFudCA9IDEgfCAyIHwgMyB8IDQ7XG5cbi8qKlxuICogUmV0dXJucyB0aGUgcXVhZHJhbnQgWzEsIDRdIG9mIHBvaW50IGZyb20gY2VudGVyLiBUaGUgdmFsdWVcbiAqIGlzIGJhc2VkIG9uIHJhZGl1czogUTEgPSBbMCwgUEkgLyAyKSwgUTIgPSBbUEkgLyAyLCBQSSksXG4gKiBRMyA9IFtQSSwgKDMgKiBQSSkgLyAyKSwgUTQgPSBbKDMgKiBQSSkgLyAyLCAyICogUEkpLlxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0UXVhZHJhbnQoXG4gIHBvaW50OiBQb2ludCxcbiAgY2VudGVyOiBQb2ludCA9IG9yaWdpblBvaW50LFxuKTogUXVhZHJhbnQge1xuICBpZiAocG9pbnQueSA8IGNlbnRlci55KSB7XG4gICAgcmV0dXJuIHBvaW50LnggPiBjZW50ZXIueCA/IDEgOiAyO1xuICB9XG4gIGlmIChwb2ludC54IDwgY2VudGVyLngpIHtcbiAgICByZXR1cm4gMztcbiAgfVxuXG4gIHJldHVybiBwb2ludC55ID4gY2VudGVyLnkgPyA0IDogMTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFJhZGl1c09mUXVhZHJhbnQoXG4gIHBvaW50OiBQb2ludCxcbiAgY2VudGVyOiBQb2ludCA9IG9yaWdpblBvaW50LFxuICBxdWFkcmFudCA9IGdldFF1YWRyYW50KHBvaW50LCBjZW50ZXIpLFxuKTogbnVtYmVyIHtcbiAgY29uc3QgZGlmZlggPSBwb2ludC54IC0gY2VudGVyLng7XG4gIGNvbnN0IGRpZmZZID0gcG9pbnQueSAtIGNlbnRlci55O1xuICBjb25zdCBsZW5ndGggPSBoeXBvdChkaWZmWCwgZGlmZlkpO1xuXG4gIHN3aXRjaCAocXVhZHJhbnQpIHtcbiAgICBkZWZhdWx0OlxuICAgIGNhc2UgMTogcmV0dXJuIGFzaW4oLWRpZmZZIC8gbGVuZ3RoKTtcbiAgICBjYXNlIDI6IHJldHVybiBhc2luKC1kaWZmWCAvIGxlbmd0aCk7XG4gICAgY2FzZSAzOiByZXR1cm4gYXNpbihkaWZmWSAvIGxlbmd0aCk7XG4gICAgY2FzZSA0OiByZXR1cm4gYXNpbihkaWZmWCAvIGxlbmd0aCk7XG4gIH1cbn1cblxuLyoqXG4gKiBSZXR1cm5zIHBvc2l0aXZlIHZhbHVlIGZvciBjbG9ja3dpc2UsIG5lZ2F0aXZlIHZhbHVlIGZvclxuICogY291bnRlcmNsb2Nrd2lzZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldERpZmZSYWRpdXMoXG4gIGxhc3RRdWFkcmFudDogUXVhZHJhbnQsXG4gIGxhc3RSYWRpdXM6IG51bWJlcixcbiAgbmV4dFF1YWRyYW50OiBRdWFkcmFudCxcbiAgbmV4dFJhZGl1czogbnVtYmVyLFxuKTogbnVtYmVyIHtcbiAgc3dpdGNoIChuZXh0UXVhZHJhbnQgLSBsYXN0UXVhZHJhbnQpIHtcbiAgICBkZWZhdWx0OlxuICAgIGNhc2UgMDogcmV0dXJuIGxhc3RSYWRpdXMgLSBuZXh0UmFkaXVzO1xuICAgIGNhc2UgLTM6XG4gICAgY2FzZSAxOiByZXR1cm4gbmV4dFJhZGl1cyArIChQSSAvIDIgLSBsYXN0UmFkaXVzKTtcbiAgICBjYXNlIC0xOlxuICAgIGNhc2UgMzogcmV0dXJuIGxhc3RSYWRpdXMgKyAoUEkgLyAyIC0gbmV4dFJhZGl1cyk7XG4gICAgY2FzZSAtMjpcbiAgICBjYXNlIDI6IHtcbiAgICAgIGNvbnN0IHJhZGl1cyA9IGxhc3RSYWRpdXMgKyBQSSAtIG5leHRSYWRpdXM7XG5cbiAgICAgIHJldHVybiByYWRpdXMgPiBQSSA/IDIgKiBQSSAtIHJhZGl1cyA6IHJhZGl1cztcbiAgICB9XG4gIH1cbn1cblxuLyoqXG4gKiBDb252ZXJ0cyByYWRpdXMgdG8gZGVncmVzcy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJhZGl1c1RvRGVncmVlKHJhZGl1czogbnVtYmVyKTogbnVtYmVyIHtcbiAgcmV0dXJuIDE4MCAqIChyYWRpdXMgLyBQSSk7XG59XG4iLCJpbXBvcnQgS25vYiBmcm9tICcuLi9rbm9iJztcbmltcG9ydCBFdmVudHMgZnJvbSAnLi4vdmFsdWVzL2V2ZW50cyc7XG5pbXBvcnQge1xuICBhZGRFdmVudExpc3RlbmVycywgcmVtb3ZlRXZlbnRMaXN0ZW5lcnMsIHRyaWdnZXJFdmVudHMsXG59IGZyb20gJy4vZXZlbnRIYW5kbGVyJztcbmltcG9ydCBnZXRFdmVudFhZIGZyb20gJy4vZ2V0RXZlbnRYWSc7XG5pbXBvcnQge1xuICBnZXREaWZmUmFkaXVzLCBnZXRRdWFkcmFudCwgZ2V0UmFkaXVzT2ZRdWFkcmFudCxcbiAgcmFkaXVzVG9EZWdyZWUsXG59IGZyb20gJy4vcmFkaXVzQW5kRGVncmVlJztcblxuY29uc3QgRVZFTlRfVE9VQ0hfU1RBUlQgPSBbJ21vdXNlZG93bicsICd0b3VjaHN0YXJ0J107XG5jb25zdCBFVkVOVF9UT1VDSF9NT1ZFID0gWydtb3VzZW1vdmUnLCAndG91Y2htb3ZlJ107XG5jb25zdCBFVkVOVF9UT1VDSF9FTkQgPSBbJ21vdXNldXAnLCAndG91Y2hlbmQnXTtcbmNvbnN0IEVWRU5UX1NQSU5fU1RBUlQgPSBbRXZlbnRzLnNwaW5TdGFydF07XG5jb25zdCBFVkVOVF9TUElOSU5HID0gW0V2ZW50cy5zcGluaW5nLCBFdmVudHMuY2hhbmdlXTtcbmNvbnN0IEVWRU5UX1NQSU5fRU5EID0gW0V2ZW50cy5zcGluRW5kLCBFdmVudHMuY2hhbmdlZF07XG5cbmludGVyZmFjZSBTcGluRXZlbnREZXRhaWwge1xuICBkZWdyZWU6IG51bWJlcjtcbiAgb2Zmc2V0RGVncmVlOiBudW1iZXI7XG59XG5cbi8qKlxuICogSGFuZGxlcyBzcGluc3RhcnQgZXZlbnQgYmluZGVkIHdpdGggbW91c2VzdGFydC90b3VjaHN0YXJ0XG4gKiBldmVudHMuXG4gKi9cbmZ1bmN0aW9uIHNwaW5TdGFydExpc3RlbmVyKFxuICB0aGlzOiBLbm9iLFxuICBldmVudDogTW91c2VFdmVudCB8IFRvdWNoRXZlbnQsXG4pOiB2b2lkIHtcbiAgY29uc3Qge1xuICAgIGRlZ3JlZTogbGFzdERlZ3JlZSxcbiAgfSA9IHRoaXM7XG4gIGNvbnN0IHN0YXJ0RXZlbnREZXRhaWw6IFNwaW5FdmVudERldGFpbCA9IHtcbiAgICBkZWdyZWU6IGxhc3REZWdyZWUsXG4gICAgb2Zmc2V0RGVncmVlOiAwLFxuICB9O1xuICBjb25zdCBhbGxTdGFydEV2ZW50c1Bhc3NlZCA9IHRyaWdnZXJFdmVudHM8U3BpbkV2ZW50RGV0YWlsPihcbiAgICB0aGlzLFxuICAgIEVWRU5UX1NQSU5fU1RBUlQsXG4gICAgeyBkZXRhaWw6IHN0YXJ0RXZlbnREZXRhaWwgfSxcbiAgKTtcblxuICBpZiAoIWFsbFN0YXJ0RXZlbnRzUGFzc2VkKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3Qge1xuICAgIHRvcCwgcmlnaHQsIGJvdHRvbSwgbGVmdCxcbiAgfSA9IHRoaXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gIGNvbnN0IGNlbnRlciA9IHtcbiAgICB4OiAocmlnaHQgKyBsZWZ0KSAvIDIsXG4gICAgeTogKHRvcCArIGJvdHRvbSkgLyAyLFxuICB9O1xuICBjb25zdCBzdGFydFByZXNzUG9pbnQgPSBnZXRFdmVudFhZKGV2ZW50KTtcbiAgY29uc3Qgc3RhcnRQcmVzc1F1YWRyYW50ID0gZ2V0UXVhZHJhbnQoXG4gICAgc3RhcnRQcmVzc1BvaW50LFxuICAgIGNlbnRlcixcbiAgKTtcbiAgY29uc3Qgc3RhcnRQcmVzc1JhZGl1cyA9IGdldFJhZGl1c09mUXVhZHJhbnQoXG4gICAgc3RhcnRQcmVzc1BvaW50LFxuICAgIGNlbnRlcixcbiAgICBzdGFydFByZXNzUXVhZHJhbnQsXG4gICk7XG5cbiAgbGV0IHRvdGFsRGlmZkRlZ3JlZSA9IDA7XG4gIGxldCBsYXN0UXVhZHJhbnQgPSBzdGFydFByZXNzUXVhZHJhbnQ7XG4gIGxldCBsYXN0UmFkaXVzID0gc3RhcnRQcmVzc1JhZGl1cztcblxuICAvKipcbiAgICogSGFuZGxlcyBzcGluaW5nL2NoYW5naW5nIGV2ZW50cyBiaW5kZWQgd2l0aFxuICAgKiBtb3VzZW1vdmUvdG91Y2htb3ZlIGV2ZW50cy5cbiAgICovXG4gIGNvbnN0IHNwaW5pbmdMaXN0ZW5lciA9IChldnQ6IE1vdXNlRXZlbnQgfCBUb3VjaEV2ZW50KSA9PiB7XG4gICAgY29uc3QgcHJlc3NQb2ludCA9IGdldEV2ZW50WFkoZXZ0KTtcbiAgICBjb25zdCBwcmVzc1F1YWRyYW50ID0gZ2V0UXVhZHJhbnQoXG4gICAgICBwcmVzc1BvaW50LFxuICAgICAgY2VudGVyLFxuICAgICk7XG4gICAgY29uc3QgcHJlc3NSYWRpdXMgPSBnZXRSYWRpdXNPZlF1YWRyYW50KFxuICAgICAgcHJlc3NQb2ludCxcbiAgICAgIGNlbnRlcixcbiAgICAgIHByZXNzUXVhZHJhbnQsXG4gICAgKTtcbiAgICBjb25zdCBkaWZmUmFkaXVzID0gZ2V0RGlmZlJhZGl1cyhcbiAgICAgIGxhc3RRdWFkcmFudCxcbiAgICAgIGxhc3RSYWRpdXMsXG4gICAgICBwcmVzc1F1YWRyYW50LFxuICAgICAgcHJlc3NSYWRpdXMsXG4gICAgKTtcbiAgICBjb25zdCBkaWZmRGVncmVlID0gcmFkaXVzVG9EZWdyZWUoZGlmZlJhZGl1cyk7XG5cbiAgICB0b3RhbERpZmZEZWdyZWUgKz0gZGlmZkRlZ3JlZTtcblxuICAgIGNvbnN0IG5leHREZWdyZWUgPSBsYXN0RGVncmVlICsgdG90YWxEaWZmRGVncmVlO1xuICAgIGNvbnN0IGRldGFpbDogU3BpbkV2ZW50RGV0YWlsID0ge1xuICAgICAgZGVncmVlOiBuZXh0RGVncmVlLFxuICAgICAgb2Zmc2V0RGVncmVlOiB0b3RhbERpZmZEZWdyZWUsXG4gICAgfTtcbiAgICBjb25zdCBhbGxNb3ZlRXZlbnRzUGFzc2VkID0gdHJpZ2dlckV2ZW50czxTcGluRXZlbnREZXRhaWw+KFxuICAgICAgdGhpcyxcbiAgICAgIEVWRU5UX1NQSU5JTkcsXG4gICAgICB7IGRldGFpbCB9LFxuICAgICk7XG5cbiAgICBsYXN0UXVhZHJhbnQgPSBwcmVzc1F1YWRyYW50O1xuICAgIGxhc3RSYWRpdXMgPSBwcmVzc1JhZGl1cztcblxuICAgIGlmICghYWxsTW92ZUV2ZW50c1Bhc3NlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMuZGVncmVlID0gbmV4dERlZ3JlZTtcbiAgfTtcblxuICAvKipcbiAgICogSGFuZGxlcyBzcGluZW5kL2NoYW5nZWQgZXZlbnRzIGJpbmRlZCB3aXRoIG1vdXNldXAvdG91Y2hlbmRcbiAgICogZXZlbnRzLlxuICAgKi9cbiAgY29uc3Qgc3BpbkVuZExpc3RlbmVyID0gKCkgPT4ge1xuICAgIGNvbnN0IHsgZGVncmVlIH0gPSB0aGlzO1xuICAgIGNvbnN0IGVuZEV2ZW50T3B0aW9ucyA9IHtcbiAgICAgIGRldGFpbDoge1xuICAgICAgICBkZWdyZWUsXG4gICAgICAgIG9mZnNldERlZ3JlZTogdG90YWxEaWZmRGVncmVlLFxuICAgICAgfSxcbiAgICB9O1xuXG4gICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcnMoZG9jdW1lbnQsIEVWRU5UX1RPVUNIX01PVkUsIHNwaW5pbmdMaXN0ZW5lcik7XG4gICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcnMoZG9jdW1lbnQsIEVWRU5UX1RPVUNIX0VORCwgc3BpbkVuZExpc3RlbmVyKTtcbiAgICB0cmlnZ2VyRXZlbnRzKHRoaXMsIEVWRU5UX1NQSU5fRU5ELCBlbmRFdmVudE9wdGlvbnMpO1xuICB9O1xuXG4gIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gIGFkZEV2ZW50TGlzdGVuZXJzKGRvY3VtZW50LCBFVkVOVF9UT1VDSF9NT1ZFLCBzcGluaW5nTGlzdGVuZXIpO1xuICBhZGRFdmVudExpc3RlbmVycyhkb2N1bWVudCwgRVZFTlRfVE9VQ0hfRU5ELCBzcGluRW5kTGlzdGVuZXIpO1xufVxuXG4vKipcbiAqIEFkZHMgbGlzdGVuZXJzIG9mIEtub2IuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhZGRTcGluTGlzdGVuZXJzKHJlZjogS25vYik6IHZvaWQge1xuICBhZGRFdmVudExpc3RlbmVycyhyZWYsIEVWRU5UX1RPVUNIX1NUQVJULCBzcGluU3RhcnRMaXN0ZW5lcik7XG59XG5cbi8qKlxuICogUmVtb3ZlcyBsaXN0ZW5lcnMgb2YgS25vYi5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZVNwaW5MaXN0ZW5lcnMocmVmOiBLbm9iKTogdm9pZCB7XG4gIHJlbW92ZUV2ZW50TGlzdGVuZXJzKHJlZiwgRVZFTlRfVE9VQ0hfU1RBUlQsIHNwaW5TdGFydExpc3RlbmVyKTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgc3BpblN0YXJ0TGlzdGVuZXI7XG4iLCJlbnVtIEF0dHJpYnV0ZXMge1xuICBkaXNhYmxlZCA9ICdkaXNhYmxlZCcsXG4gIGRlZ3JlZSA9ICdkZWdyZWUnLFxuICBtaW5EZWdyZWUgPSAnbWluJyxcbiAgbWF4RGVncmVlID0gJ21heCcsXG59XG5cbmV4cG9ydCBkZWZhdWx0IEF0dHJpYnV0ZXM7XG4iLCJpbXBvcnQge1xuICBhZGRTcGluTGlzdGVuZXJzLCByZW1vdmVTcGluTGlzdGVuZXJzLFxufSBmcm9tICcuL3V0aWxzL3NwaW5MaXN0ZW5lcic7XG5pbXBvcnQgQXR0cmlidXRlcyBmcm9tICcuL3ZhbHVlcy9hdHRyaWJ1dGVzJztcblxuY29uc3QgeyBpc05hTiB9ID0gZ2xvYmFsVGhpcztcbmNvbnN0IHRlbXBsYXRlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGVtcGxhdGUnKTtcblxudGVtcGxhdGUuaW5uZXJIVE1MID0gYFxuPHN0eWxlPlxuICA6aG9zdCB7XG4gICAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xuICAgIHRyYW5zZm9ybTogcm90YXRlKHZhcigtLWRlZ3JlZSkpO1xuICB9XG48L3N0eWxlPlxuPHNsb3Q+XG48L3Nsb3Q+XG5gO1xuXG5jbGFzcyBLbm9iIGV4dGVuZHMgSFRNTEVsZW1lbnQge1xuICBzdGF0aWMgZ2V0IG5vZGVOYW1lKCkge1xuICAgIHJldHVybiAna25vYi1iYXNlJztcbiAgfVxuXG4gICNkaXNhYmxlZDogYm9vbGVhbiA9IGZhbHNlO1xuXG4gICNtaW5EZWdyZWU6IG51bWJlciA9IC1JbmZpbml0eTtcblxuICAjbWF4RGVncmVlOiBudW1iZXIgPSBJbmZpbml0eTtcblxuICAjZGVncmVlOiBudW1iZXIgPSAwO1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKCk7XG5cbiAgICB0aGlzLmF0dGFjaFNoYWRvdyh7IG1vZGU6ICdvcGVuJyB9KTtcbiAgICAodGhpcy5zaGFkb3dSb290IGFzIFNoYWRvd1Jvb3QpXG4gICAgICAuYXBwZW5kKHRlbXBsYXRlLmNvbnRlbnQuY2xvbmVOb2RlKHRydWUpKTtcblxuICAgIE9iamVjdC52YWx1ZXMoQXR0cmlidXRlcykuZm9yRWFjaCgoYXR0ck5hbWUpID0+IHtcbiAgICAgIHRoaXMuYXR0cmlidXRlQ2hhbmdlZENhbGxiYWNrKGF0dHJOYW1lKTtcbiAgICB9KTtcbiAgfVxuXG4gIHN0YXRpYyBnZXQgb2JzZXJ2ZWRBdHRyaWJ1dGVzKCkge1xuICAgIHJldHVybiBbXG4gICAgICBBdHRyaWJ1dGVzLmRpc2FibGVkLFxuICAgICAgQXR0cmlidXRlcy5taW5EZWdyZWUsXG4gICAgICBBdHRyaWJ1dGVzLm1heERlZ3JlZSxcbiAgICAgIEF0dHJpYnV0ZXMuZGVncmVlLFxuICAgIF07XG4gIH1cblxuICBhdHRyaWJ1dGVDaGFuZ2VkQ2FsbGJhY2soYXR0ck5hbWU6IHN0cmluZykge1xuICAgIHN3aXRjaCAoYXR0ck5hbWUpIHtcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlIEF0dHJpYnV0ZXMuZGlzYWJsZWQ6XG4gICAgICAgIHRoaXMuZGlzYWJsZWQgPSB0aGlzLmhhc0F0dHJpYnV0ZShBdHRyaWJ1dGVzLmRpc2FibGVkKTtcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgQXR0cmlidXRlcy5taW5EZWdyZWU6XG4gICAgICAgIHRoaXMubWluID0gTnVtYmVyKFxuICAgICAgICAgIHRoaXMuZ2V0QXR0cmlidXRlKEF0dHJpYnV0ZXMubWluRGVncmVlKVxuICAgICAgICAgID8/IC1JbmZpbml0eSxcbiAgICAgICAgKTtcbiAgICAgICAgdGhpcy5kZWdyZWUgPSBNYXRoLm1heCh0aGlzLm1pbiwgdGhpcy5kZWdyZWUpO1xuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSBBdHRyaWJ1dGVzLm1heERlZ3JlZTpcbiAgICAgICAgdGhpcy5tYXggPSBOdW1iZXIoXG4gICAgICAgICAgdGhpcy5nZXRBdHRyaWJ1dGUoQXR0cmlidXRlcy5tYXhEZWdyZWUpXG4gICAgICAgICAgPz8gSW5maW5pdHksXG4gICAgICAgICk7XG4gICAgICAgIHRoaXMuZGVncmVlID0gTWF0aC5taW4odGhpcy5tYXgsIHRoaXMuZGVncmVlKTtcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgQXR0cmlidXRlcy5kZWdyZWU6XG4gICAgICAgIHRoaXMuZGVncmVlID0gTnVtYmVyKFxuICAgICAgICAgIHRoaXMuZ2V0QXR0cmlidXRlKEF0dHJpYnV0ZXMuZGVncmVlKVxuICAgICAgICAgID8/IDAsXG4gICAgICAgICk7XG4gICAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIHRydWUgaWYgS25vYiBpcyBkaXNhYmxlZC5cbiAgICovXG4gIGdldCBkaXNhYmxlZCgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy4jZGlzYWJsZWQ7XG4gIH1cblxuICAvKipcbiAgICogU2V0cyBLbm9iIGRpc2FibGVkLlxuICAgKi9cbiAgc2V0IGRpc2FibGVkKHZhbHVlOiBib29sZWFuKSB7XG4gICAgY29uc3QgZGlzYWJsZWQgPSBCb29sZWFuKHZhbHVlKTtcblxuICAgIGlmIChkaXNhYmxlZCkge1xuICAgICAgcmVtb3ZlU3Bpbkxpc3RlbmVycyh0aGlzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgYWRkU3Bpbkxpc3RlbmVycyh0aGlzKTtcbiAgICB9XG5cbiAgICB0aGlzLiNkaXNhYmxlZCA9IGRpc2FibGVkO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgbWluIGRlZ3JlZS5cbiAgICovXG4gIGdldCBtaW4oKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy4jbWluRGVncmVlO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldHMgbWluIGRlZ3JlZS5cbiAgICovXG4gIHNldCBtaW4obWluRGVncmVlOiBudW1iZXIpIHtcbiAgICBpZiAoaXNOYU4obWluRGVncmVlKSkge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihgSW52YWxpZCBtaW4gZGVncmVlOiAke21pbkRlZ3JlZX1gKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMubWF4IDwgbWluRGVncmVlKSB7XG4gICAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcihcbiAgICAgICAgYFVuYWJsZSB0byBzZXQgbWluIGRlZ3JlZSB0aGF0IGlzIGdyZWF0ZXIgdGhhbiBtYXggZGVncmVlOiAke21pbkRlZ3JlZX0gPiAke3RoaXMubWF4fWAsXG4gICAgICApO1xuICAgIH1cblxuICAgIHRoaXMuI21pbkRlZ3JlZSA9IG1pbkRlZ3JlZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIG1heCBkZWdyZWUuXG4gICAqL1xuICBnZXQgbWF4KCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuI21heERlZ3JlZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXRzIG1heCBkZWdyZWUuXG4gICAqL1xuICBzZXQgbWF4KG1heERlZ3JlZTogbnVtYmVyKSB7XG4gICAgaWYgKGlzTmFOKG1heERlZ3JlZSkpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoYEludmFsaWQgbWF4IGRlZ3JlZTogJHttYXhEZWdyZWV9YCk7XG4gICAgfSBlbHNlIGlmICh0aGlzLm1pbiA+IG1heERlZ3JlZSkge1xuICAgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoXG4gICAgICAgIGBVbmFibGUgdG8gc2V0IG1heCBkZWdyZWUgdGhhdCBpcyBsZXNzIHRoYW4gbWluIGRlZ3JlZTogJHttYXhEZWdyZWV9IDwgJHt0aGlzLm1pbn1gLFxuICAgICAgKTtcbiAgICB9XG5cbiAgICB0aGlzLiNtYXhEZWdyZWUgPSBtYXhEZWdyZWU7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBkZWdyZWUuXG4gICAqL1xuICBnZXQgZGVncmVlKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuI2RlZ3JlZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXRzIGRlZ3JlZS5cbiAgICovXG4gIHNldCBkZWdyZWUodmFsdWU6IG51bWJlcikge1xuICAgIGlmICh2YWx1ZSA9PT0gdGhpcy5kZWdyZWUpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGlzTmFOKHZhbHVlKSkge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihgSW52YWxpZCBkZWdyZWU6ICR7dmFsdWV9YCk7XG4gICAgfVxuXG4gICAgY29uc3QgZGVncmVlID0gTWF0aC5tYXgoXG4gICAgICBNYXRoLm1pbih2YWx1ZSwgdGhpcy5tYXgpLFxuICAgICAgdGhpcy5taW4sXG4gICAgKTtcblxuICAgIHRoaXMuc3R5bGUuc2V0UHJvcGVydHkoJy0tZGVncmVlJywgYCR7ZGVncmVlfWRlZ2ApO1xuICAgIHRoaXMuI2RlZ3JlZSA9IGRlZ3JlZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBbGlhcyBvZiBkZWdyZWUuXG4gICAqL1xuICBnZXQgdmFsdWUoKSB7XG4gICAgcmV0dXJuIHRoaXMuZGVncmVlO1xuICB9XG5cbiAgc2V0IHZhbHVlKHZhbHVlKSB7XG4gICAgdGhpcy5kZWdyZWUgPSB2YWx1ZTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBLbm9iO1xuIiwiLyogZXNsaW50LWRpc2FibGUgbm8tY29uc29sZSAqL1xuXG5pbXBvcnQgS25vYiBmcm9tICcuL2tub2InO1xuXG5jb25zdCBrbm9iTm9kZU5hbWUgPSBLbm9iLm5vZGVOYW1lO1xuXG5pZiAoY3VzdG9tRWxlbWVudHMuZ2V0KGtub2JOb2RlTmFtZSkpIHtcbiAgY29uc29sZS53YXJuKGBBbHJlYWR5IGRlZmluZWQgPCR7a25vYk5vZGVOYW1lfT5gKTtcbn0gZWxzZSB7XG4gIGN1c3RvbUVsZW1lbnRzLmRlZmluZShrbm9iTm9kZU5hbWUsIEtub2IpO1xufVxuXG5jdXN0b21FbGVtZW50cy53aGVuRGVmaW5lZChrbm9iTm9kZU5hbWUpXG4gIC50aGVuKCgpID0+IHtcbiAgICBjb25zb2xlLmluZm8oYEtub2IuanMgaXMgZGVmaW5lZCBhcyA8JHtrbm9iTm9kZU5hbWV9PmApO1xuICB9KTtcbiJdLCJuYW1lcyI6WyJFdmVudHMiLCJhZGRFdmVudExpc3RlbmVycyIsInJlZiIsInR5cGVzIiwibGlzdGVuZXIiLCJvcHRpb25zIiwiZm9yRWFjaCIsInR5cGUiLCJhZGRFdmVudExpc3RlbmVyIiwicmVtb3ZlRXZlbnRMaXN0ZW5lcnMiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwidHJpZ2dlckV2ZW50cyIsImV2ZXJ5IiwiZGlzcGF0Y2hFdmVudCIsIkN1c3RvbUV2ZW50IiwidHJpZ2dlckV2ZW50IiwiZXZlbnQiLCJNb3VzZUV2ZW50IiwieCIsImNsaWVudFgiLCJ5IiwiY2xpZW50WSIsIlRvdWNoRXZlbnQiLCJ0b3VjaGVzIiwidG91Y2giLCJSZWZlcmVuY2VFcnJvciIsIlBJIiwiaHlwb3QiLCJhc2luIiwiTWF0aCIsIm9yaWdpblBvaW50IiwiZ2V0UXVhZHJhbnQiLCJwb2ludCIsImNlbnRlciIsImdldFJhZGl1c09mUXVhZHJhbnQiLCJxdWFkcmFudCIsImRpZmZYIiwiZGlmZlkiLCJsZW5ndGgiLCJFVkVOVF9UT1VDSF9TVEFSVCIsIkVWRU5UX1RPVUNIX01PVkUiLCJFVkVOVF9UT1VDSF9FTkQiLCJFVkVOVF9TUElOX1NUQVJUIiwiRVZFTlRfU1BJTklORyIsIkVWRU5UX1NQSU5fRU5EIiwic3BpblN0YXJ0TGlzdGVuZXIiLCJkZWdyZWUiLCJsYXN0RGVncmVlIiwidGhpcyIsImRldGFpbCIsIm9mZnNldERlZ3JlZSIsInRvcCIsInJpZ2h0IiwiYm90dG9tIiwibGVmdCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsInN0YXJ0UHJlc3NQb2ludCIsImdldEV2ZW50WFkiLCJzdGFydFByZXNzUXVhZHJhbnQiLCJzdGFydFByZXNzUmFkaXVzIiwidG90YWxEaWZmRGVncmVlIiwibGFzdFF1YWRyYW50IiwibGFzdFJhZGl1cyIsInNwaW5pbmdMaXN0ZW5lciIsImV2dCIsInByZXNzUG9pbnQiLCJwcmVzc1F1YWRyYW50IiwicHJlc3NSYWRpdXMiLCJkaWZmUmFkaXVzIiwibmV4dFF1YWRyYW50IiwibmV4dFJhZGl1cyIsInJhZGl1cyIsImdldERpZmZSYWRpdXMiLCJuZXh0RGVncmVlIiwiYWxsTW92ZUV2ZW50c1Bhc3NlZCIsInNwaW5FbmRMaXN0ZW5lciIsImVuZEV2ZW50T3B0aW9ucyIsImRvY3VtZW50IiwicHJldmVudERlZmF1bHQiLCJBdHRyaWJ1dGVzIiwiaXNOYU4iLCJnbG9iYWxUaGlzIiwidGVtcGxhdGUiLCJjcmVhdGVFbGVtZW50IiwiaW5uZXJIVE1MIiwiS25vYiIsIkhUTUxFbGVtZW50IiwiSW5maW5pdHkiLCJjb25zdHJ1Y3RvciIsInN1cGVyIiwiYXR0YWNoU2hhZG93IiwibW9kZSIsInNoYWRvd1Jvb3QiLCJhcHBlbmQiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiT2JqZWN0IiwidmFsdWVzIiwiYXR0ck5hbWUiLCJhdHRyaWJ1dGVDaGFuZ2VkQ2FsbGJhY2siLCJkaXNhYmxlZCIsImhhc0F0dHJpYnV0ZSIsIm1pbiIsIk51bWJlciIsImdldEF0dHJpYnV0ZSIsIm1heCIsInZhbHVlIiwiQm9vbGVhbiIsIm1pbkRlZ3JlZSIsIlR5cGVFcnJvciIsIlJhbmdlRXJyb3IiLCJtYXhEZWdyZWUiLCJzdHlsZSIsInNldFByb3BlcnR5Iiwia25vYk5vZGVOYW1lIiwiY3VzdG9tRWxlbWVudHMiLCJnZXQiLCJjb25zb2xlIiwid2FybiIsImRlZmluZSIsIndoZW5EZWZpbmVkIiwidGhlbiIsImluZm8iXSwic291cmNlUm9vdCI6IiJ9